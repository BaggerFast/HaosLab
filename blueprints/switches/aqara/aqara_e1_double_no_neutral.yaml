blueprint:
  name: Aqara E1 double switch no neutral
  description: Ð¡ontrol an Aqara E1 double switch (no neutral) via HA. Supports single and double clicks for both, left and right buttons.
  domain: automation
  author: BaggerFast
  input:
    switch_device:
      name: Switch
      selector:
        device:
          filter:
            integration: mqtt
            manufacturer: Aqara
            model: Smart wall switch E1 (no neutral, double rocker)
    left_single:
      name: Left - single action
      default: []
      selector:
        action: {}
    left_double:
      name: Left - single action
      default: []
      selector:
        action: {}
    right_single:
      name: Right - single action
      default: [] 
      selector:
        action: {}
    right_double:
      name: Right - single action
      default: []
      selector:
        action: {}
    both_single:
      name: Both - single action
      default: []
      selector:
        action: {}
    both_double:
      name: Both - double action
      default: []
      selector:
        action: {}

mode: restart
max_exceeded: silent

triggers:
  - trigger: device
    device_id: !input switch_device
    domain: mqtt
    type: action
    subtype: single_left
  - trigger: device
    device_id: !input switch_device
    domain: mqtt
    type: action
    subtype: double_left
  - trigger: device
    device_id: !input switch_device
    domain: mqtt
    type: action
    subtype: single_right
  - trigger: device
    device_id: !input switch_device
    domain: mqtt
    type: action
    subtype: double_right
  - trigger: device
    device_id: !input switch_device
    domain: mqtt
    type: action
    subtype: double_both
  - trigger: device
    device_id: !input switch_device
    domain: mqtt
    type: action
    subtype: single_both
action:
  - variables:
      key: "{{ trigger.payload }}"
  - choose:
      - conditions:
          - '{{ key == "single_left" }}'
        sequence: !input left_single
      - conditions:
          - '{{ key == "double_left" }}'
        sequence: !input left_double
      - conditions:
          - '{{ key == "single_right" }}'
        sequence: !input right_single
      - conditions:
          - '{{ key == "double_right" }}'
        sequence: !input right_double
      - conditions:
          - '{{ key == "double_both" }}'
        sequence: !input both_double
      - conditions:
          - '{{ key == "single_both" }}'
        sequence: !input both_single

